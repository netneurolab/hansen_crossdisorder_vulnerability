# Molecular and connectomic vulnerability shape cross-disorder cortical abnormalities
This repository contains code and data created in support of my project, "Molecular and connectomic vulnerability shape cross-disorder cortical abnormalities".
All code was written in Python.

## Code
The [code](code/) folder contains the scripts required to conduct the main analyses:
- [00_get_predictors_and_atrophy_maps.py](code/00_get_predictors_and_atrophy_maps.py) puts together the list of molecular and connectomic predictors used in the main analysis, and puts together [ENIGMA](http://enigma.ini.usc.edu/)-derived case versus control cortical abnormality maps for 13 different disorders/diseases/conditions. I used the [enigma toolbox](https://enigma-toolbox.readthedocs.io/en/latest/) to fetch most of these profiles. This script generates the figures used in Figure 1 of the manuscript.
- [01_regression_and_dominance.py](code/01_regression_and_dominance.py) runs the primary analysis of the project, which uses an in-house implemented version of [dominance analysis](https://github.com/dominance-analysis/dominance-analysis). This script generates the figures used in Figures 2 and 3 of the manuscript.
- [02_network_spreading.py](code/02_network_spreading.py) calculates the degree to which disorders demonstrate "network-informed" or "network-spreading" cortical abnormalities, an analysis that was originally developed by [Shafiei et al., 2019](https://www.biologicalpsychiatryjournal.com/article/S0006-3223(19)31785-8/fulltext). This script generates the figures used in Figure 4 of the manuscript.
- [03_disorder_similarity.py](code/03_disorder_similarity.py) compares disorder similarity to other similarity matrices as well as the structural and functional connectomes. This script generates the figures used in Figure 5 of the manuscript.

## Data
The [data](data/) folder contains the data I use to run my analyses.
Here I list out the directories and some files of interest:
- [enigma](data/enigma/) contains [ENIGMA](http://enigma.ini.usc.edu/) maps that are (or were) not included in the [enigma toolbox](https://enigma-toolbox.readthedocs.io/en/latest/). These files come from me scavenging supplementary tables which sometimes come as PDF files and were therefore copy-pasted into something for my scrpit to read. Sorry.
- [predictors](data/predictors/) contains parcellated molecular predictor maps that I use in the main analysis
- I eventually save my predictor matrices in [local_biol_predictors.csv](data/local_biol_predictors.csv) and [global_conn_predictors.csv](data/global_conn_predictors.csv). The names/order of the variables are stored in `{bio/conn}_predictor_names.npy`. There are some other versions of the connectivity predictors, as well as MEG-derived temporal predictors, that I use in the supplementary analyses.
- I save my region by disorder matrix of cortical abnormalities in [enigma_ct.csv](data/enigma_ct.csv).
- Richard Carson and Kelly Smart from the Yale PET Centre shared [this](data/avg_ucbj_bp_n76_reg.nii.gz) PET map, which is of a tracer (UCBJ) that binds to the synaptic vesicle glycoprotein 2A and therefore indexes synapse density.

## Results
The [results](results/) folder contains the saved outputs from the code scripts, including outputs from cross-validating, the dominance analysis results, and a bunch of null distributions I don't want to lose.
